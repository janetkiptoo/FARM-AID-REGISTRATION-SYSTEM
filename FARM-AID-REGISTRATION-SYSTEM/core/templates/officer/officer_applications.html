{% extends "base_officer.html" %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="{% static 'core/css/styles.css' %}">

<div class="table-container">
  <h2 class="page-title">Aid Applications</h2>

  {% if messages %}
  <ul class="messages">
    {% for message in messages %}
      <li class="message {{ message.tags }}">{{ message }}</li>
    {% endfor %}
  </ul>
  {% endif %}

  <table class="aid-table">
    <thead>
      <tr>
        <th>Farmer</th>
        <th>Resource Needed</th>
        <th>Status</th>
        <th>Applied At</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for app in applications %}
      <tr>
        <td>{{ app.farmer.full_name }}</td>
        <td>{{ app.resources_needed }}</td>
        <td>
          <span class="status-tag status-{{ app.status|lower }}">{{ app.status|title }}</span>
        </td>
        <td>{{ app.applied_at|date:"Y-m-d H:i" }}</td>
        <td>
          {% if app.status == 'pending' %}
            <a href="{% url 'update_application_status' app.id 'approved' %}" class="action-btn approve">Approve</a>
            <a href="{% url 'update_application_status' app.id 'rejected' %}" class="action-btn reject">Reject</a>
          {% elif app.status == 'approved' %}
            <span class="status-tag status-approved">✅ Approved</span>
          {% else %}
            <span class="status-tag status-rejected">❌ Rejected</span>
          {% endif %}
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="5" class="no-data">No applications found.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
